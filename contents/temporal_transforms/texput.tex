% Emacs, this is -*-latex-*-

% https://vcgit.hhi.fraunhofer.de/jvet
% https://www.etsist.upm.es/uploaded/392/02_Video_Compression_Basics_MPEG1_MPEG2_MPEG4.pdf

\input{../../definitions}
\title{\SM{} - \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/tree/master/contents/temporal_transforms}{Temporal Transforms}}

\maketitle
\tableofcontents

\section{Temporal transforms exploit temporal redundancy}


\section{Temporal redundancy}
%{{{

In general, neighbour \emph{frames} (images) in (video)
\emph{sequences} exhibit a high temporal correlation that can be
exploited to increase the compression ratios. The removal of such
redundancy can be performed by transforms applied to the temporal
domain.

A temporal transform inputs two o more frames\footnote{With pixels or
coefficients, depending on the current domain of the frame.}, and
outputs at least one \emph{residual} (frame) in which the
residual pixels have a higher dynamic range but also a smaller
entropy. This potentially increases the compression ratios.

%}}}

\section{Motion Compensation (MC)}
%{{{

In most video coding standards,
\href{https://en.wikipedia.org/wiki/Motion_compensation}{Motion
  Compensation (MC)} is used to generate the residual
frames. Therefore, MC exploits the temporal correlation to reduce the
entropy of the residuals\footnote{The better the prediction, the lower
  the entropy of the residuals.}. Basically, MC consists in
substracting to the video data a prediction performed with the
information that must be also avaliable\footnote{In order to make a
  reversible process.} at the decoder~\cite{vruiz__MC}. Notice that,
after using MC, the number of residual-pixels is equal to the number
of pixels in the compensated frame.

%}}}

\section{Motion Estimation (ME) and RDO}
%{{{

In general, MC requires to estimate the motion~\cite{vruiz__ME}
between the frames that are compensated. ME is a key process because
it will affect to the quality of the predictions and to the
bit-rate.\footnote{In general, $D$ will decrease if the ``motion
  part'' of $R$ increases.}

ME can be computed to minimize the distortion\footnote{Including, the
  visual distortion.} $D$ of the residues or can be computed to
minimize the lagrangian
\begin{equation}
  J = R + \lambda D,
\end{equation}
which also takes into consideration the bit-rate $R$ generated by the
entropy encoding of the motion data and the residues.

%}}}

\section{GOF-ing}

The RD performance of ME/MC depends on the amount of temporal
redundancy in the sequence. If such amount is low, it is more RD
efficient to interrupt the MC. The set of consecutive frames in which
MC is active is usually known as a GOF (Group of Frames). Notice that
(under the RD prism) the length of the GOFs is variable and therefore,
the GOF partition is an adaptive process.

However, in some contexts it can be necessary to use a fixed GOP
partition (see the Section~\ref{sec:random}).

\section{Block-based MC}

The MC schemes used in most video coding standards compensate blocks
of pixels~\cite{vruiz__BBMC}. In this context, depending of the RDO
procesure, blocks can be:
\begin{enumerate}
\item I-type, when the block is encoded without considering reference
  information (no resudue is generated). A I-type block represents
  only texture.
\item P-type, if there is one reference for the block. Now we encode a
  residual texture and a motion vector.
\item B-type, if there are two or more references for the block. In
  this case the nyumber of motion vectors increases compared to P-type
  blocks, but in general the entropy of the residual texture
  decreases.
\item S-type, if the residue is so small that it is more beneficial to
  consider that it is zero.
\end{enumerate}

\section{Intra coding (III...)}

In a III... ``MC'' scheme, all frames are encoded as independent
images (no MC has been used at all). All blocks in the frames are
I-type, by definition. Intra-coded frames are also named keyframes.

Advantages:
\begin{itemize}
\item [+] Minimal pipeline delay.
\item [+] No error propagation.
\item [+] Maximum temporal scalability.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] Low compression ratios.
\end{enumerate}

Mainly used in video edition.

\section{Low-delay coding (IPPP...)}

In a GOP, only the first frame is intra-coded and the rest,
predictive-codec using motion compensation. In a P-frame, blocks can
be of (depending on RDO):
\begin{enumerate}
\item I-type: the block is intra-coded.
\item P-type: the block is predicted using a block that belong to a previous frame.
\item S-type: the residue of the prediction is so small that it is considered as zero.
\end{enumerate}

Advantages:
\begin{itemize}
\item [+] Low pipeline delay (one frame-time).
\item [+] Medium-high compression ratios.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] Error propagation sequentially, until the next GOF.
\item [-] Low temporal scalability.
\end{enumerate}

Mainly used in surveillance.

\section{``Random''-access mode (IBPB...)}
\label{sec:random}

In a GOP, some or all the residue frames can be P or B-type. In a
B-type frame, blocks can be (depending on RDO) of B-type, which means
that at leas two blocks, one of them in a past frame and other in a
future frame, are used as reference blocks during the motion
compensation.

Notice that. by definition, the low-delay coding mode is also a
random-access mode.

Advantages:
\begin{itemize}
\item [+] High compression ratios.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] High pipeline delay (until a GOF-time).
\item [-] Error propagation (depending on the block-type decissions),
  until the next GOF.
\item [-] Low temporal scalability.
\end{enumerate}

\section{Resources}

\section{To-Do}
%{{{

\begin{enumerate}
\item Modify VCF to encode/decode a sequence of images using a
  III... scheme. Complexity 1.
\item Modify VCF to encode/decode a sequence of images using a
  IPP... scheme, without motion compensation. Complexity 2.
\item Modify VCF to encode/decode a sequence of images using a
  IPP... scheme, with motion compensation. Complexity 4.
\item Modify VCF to encode/decode a sequence of images using a
  IBB... scheme, with motion compensation. Complexity 5.
\end{enumerate}

%}}}
  
\section{References}
%{{{

\renewcommand{\addcontentsline}[3]{}% Remove functionality of \addcontentsline
\bibliography{image_pyramids,DWT,motion_estimation,HEVC}

%}}}
