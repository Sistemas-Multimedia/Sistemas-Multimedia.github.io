% Emacs, this is -*-latex-*-

% https://vcgit.hhi.fraunhofer.de/jvet
% https://www.etsist.upm.es/uploaded/392/02_Video_Compression_Basics_MPEG1_MPEG2_MPEG4.pdf

\input{../../definitions}
\title{\SM{} - \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/tree/master/contents/temporal_transforms}{Temporal Transforms}}

\maketitle
\tableofcontents

\section{Temporal correlation}
%{{{

In general, neighbour \emph{frames} (images) in (video)
\emph{sequences} exhibit a high temporal correlation that can be
exploited to increase the compression ratios. The removal of such
redundancy can be performed by transforms applied to the temporal
domain.

A temporal transform inputs two o more frames\footnote{With pixels or
  coefficients, depending on the current domain of the frame. Notice,
  for example, that if the frame is in the DWT domain, we should refer
  to it as a decomposition.}, and outputs at least one \emph{residual}
(frame) in which the residual pixels have a higher dynamic range but
also a smaller entropy. This potentially increases the compression
ratios.

Notice that, since we already handle the concept of FPS (Frames Per
Second), we can also have a bit-rate (usually expressed in kilo bits
per second (kbps) or mega bits per second (Mbps)).

%}}}

\section{Motion Compensation (MC)}
%{{{

Most video coding standards use
\href{https://en.wikipedia.org/wiki/Motion_compensation}{Motion
  Compensation (MC)} to generate the residual
frames. Therefore, MC exploits the temporal correlation to reduce the
entropy of the residuals\footnote{The better the prediction, the lower
  the entropy of the residuals.}. Basically, MC consists in
substracting to each original frame a prediction (frame) build with the
information that must be also avaliable\footnote{In order to make a
  reversible process.} at the decoder~\cite{vruiz__MC}. Notice that,
after using MC, the number of residual-pixels is equal to the number
of pixels in the compensated frame.

%}}}

\section{Motion Estimation (ME) and RDO}
%{{{

In general, MC requires to estimate the motion~\cite{vruiz__ME}
between the frames that are compensated. ME is a key process because
it will affect to the quality of the predictions and to the
bit-rate.\footnote{In general, the distortion $D$ will decrease if the
  ``motion part'' of the bit-rate $R$ increases.}

ME can be computed to minimize the distortion\footnote{Including, the
  visual distortion.} $D$ of the residues, or can be computed to
minimize the lagrangian
\begin{equation}
  J = R + \lambda D,
\end{equation}
which also takes into consideration the bit-rate $R$ generated by the
entropy encoding of the motion data and the residues.

In general, most video codecs only minimize $D$.

%}}}

\section{GOF-ing}

The RD performance of ME/MC depends on the amount of temporal
redundancy in the sequence. If such amount is low, it can be more
RD-efficient to interrupt the MC process. The set of consecutive
frames in which MC is active is usually known as a GOF\footnote{Some
  standards also use GOP (Group Of Pictures).} (Group of
Frames). Notice that (under the RD prism) the length of the GOFs is
variable and therefore, the GOF partition can be an adaptive process.

However, in some contexts it can be necessary to use a fixed GOP
partition (see the Section~\ref{sec:random}).

\section{Block-based MC}

The MC schemes used in most video coding standards compensate blocks
of pixels. In this context, depending of the block decision mode
implemented in the RDO procedure\footnote{Obviously, the part of the
  RDO procedure that controls the block-type.}, blocks can be of
different type (I (intra), P (predicted), B
(bidirectionally-predicted) and S (skipped))~\cite{vruiz__MEC}.

\section{I-type frames, P-type frames and B-type frames}

Frames can be:

\begin{enumerate}
\item I-type (or simly a I-frame), if only uses I-type blocks.
\item P-type frame (P-frame), that can use I, P, and S-type blocks.
\item B-type frame (B-frame), if I, P, S and B-type blocks can be
  used.
\end{enumerate}

\section{Intra coding (III...)}

In the intra coding mode, all frames are encoded as independent
images (no MC has been used at all, and therefore, all blocks in the
frames are I-type). Intra-coded frames are also called keyframes.

Advantages:
\begin{itemize}
\item [+] Minimal pipeline delay.
\item [+] Minimal buffering.
\item [+] No error propagation.
\item [+] Maximum temporal scalability.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] Low compression ratios.
\end{enumerate}

Mainly used in video edition.

\section{Low-delay coding (IPP...)}

In the low-delay coding mode, only the first frame is intra-coded and
the rest, prediction-coded using unidirectional motion
compensation.
% In a P-frame, blocks can be (depending on RDO) of:
% \begin{enumerate}
% \item I-type, if the block is intra-coded.
% \item P-type, if the block is predicted using a block that belong to a previous frame.
% \item S-type, if the residue of the prediction is so small that it is considered as zero.
%\end{enumerate}

Advantages:
\begin{itemize}
\item [+] Low pipeline delay (one frame-time).
\item [+] Usually, only one frame buffering.
\item [+] Medium-high compression ratios.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] Error propagation sequentially, until the next GOF.
\item [-] Low temporal scalability.
\end{enumerate}

Mainly used in video surveillance.

\section{``Random''-access mode (IBPB...)}
\label{sec:random}

In the random-access mode it is allowed to use B-type frames.
%, some or all the residue frames can be P or
%B-type. In a B-type frame, blocks can be (depending on RDO) of B-type,
%which means that at leas two blocks, one of them in a past frame and
%other in a future frame, are used as reference blocks during the
%motion compensation.
Notice that. by definition, the low-delay coding mode is also a
random-access mode.

Advantages:
\begin{itemize}
\item [+] The highest compression ratio.
\end{itemize}

Disadvantages:
\begin{enumerate}
\item [-] High pipeline delay (up to GOF-time).
\item [-] Error propagation (depending on the block-type decisions),
  until the next GOF.
\item [-] Low temporal scalability.
\end{enumerate}

\section{Resources}

\section{To-Do}
%{{{

\begin{enumerate}
\item Modify VCF to encode/decode a sequence of images using a
  III... scheme. Complexity 1.
\item Modify VCF to encode/decode a sequence of images using a
  IPP... scheme, without motion compensation. Complexity 2.
\item Modify VCF to encode/decode a sequence of images using a
  IPP... scheme, with motion compensation. Complexity 4.
\item Modify VCF to encode/decode a sequence of images using a
  IBB... scheme, with motion compensation. Complexity 5.
\end{enumerate}

%}}}
  
\section{References}
%{{{

\renewcommand{\addcontentsline}[3]{}% Remove functionality of \addcontentsline
\bibliography{image_pyramids,DWT,motion_estimation,HEVC}

%}}}
