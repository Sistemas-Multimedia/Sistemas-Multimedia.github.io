% Emacs, this is -*-latex-*-

\input{../../definitions}
\title{\SM{} - Scalar Quantization of Gray-scale Images}

\maketitle
\tableofcontents

\section{Objective}
This task shows how to implement a very simple
\href{https://en.wikipedia.org/wiki/Lossy_compression}{lossy}
\href{https://en.wikipedia.org/wiki/Grayscale}{(gray-scale) image}
\href{https://en.wikipedia.org/wiki/Image_compression}{compressor}~\cite{vruiz__image_IO}
based on Scalar
Quantization~\cite{vruiz__scalar_quantization,sayood2017introduction,vetterli2014foundations}
and PNG~\cite{vruiz__PNG}. This compressor basically removes the
number of different gray
\href{https://en.wikipedia.org/w/index.php?title=Tone_(color)&redirect=no}{tones}
in a single-channel image (normally,
\href{https://en.wikipedia.org/wiki/Visual_system}{humans} hardly
distinguish more than 64 different
\href{https://en.wikipedia.org/wiki/Color}{colors}). Therefore, the
main objective of this task is to analyze the impact in the encoding
performance (in terms of a RD (Rate/Distortion)
curve~\cite{vruiz__information_theory}) when the visual redundancy is
exploited.

\section{Scalar quantization applied to the ``intensity'' domain of a gray-scale image}
The notetooks
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_deadzone.ipynb}{gray\_SQ\_deadzone.ipynb},
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_LloydMax.ipynb}{gray\_SQ\_LloydMax.ipynb},
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_companded.ipynb}{gray\_SQ\_companded.ipynb},
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_midrise.ipynb}{gray\_SQ\_midrise.ipynb},
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_midtread.ipynb}{gray\_SQ\_midtread.ipynb}
and
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/compare_quantizers.ipynb}{compare\_quantizers.ipynb})
shows the RD performance of different scalar quantizers. As you can
see, the way in which the visual information is quantized has an
influence in the RD performance. Also, as it can be checked in the
notebooks, in general, the better quantizer is the Lloyd-Max quantizer
because it adapts the QSSs (Quantization Step Sizes) to the
\href{https://en.wikipedia.org/wiki/Probability_density_function}{PDF
  (Probability Density Function)} of the image. However, notice also
that, since the QSS depends on the image, they must be ``transmitted''
to the decoder, which decreases the definitive RD performance.

Notice also the remarkable perormance of the DeadZone Quantizer (DZQ)
at low bit-rates. The DZQ is the prefered scalar quantizer used in
image and video coding because of this, and also, because when the
QSSs are powers of two, we can use an
\href{https://en.wikipedia.org/wiki/Bit_plane}{bit-plane}-based
entropy encoder.

using the
quantization step sizes~\cite{vruiz__scalar_quantization}
$\Delta\in\{128, 64, 32, 16, 8, 4, 2, 1\}$\footnote{There are two
reasons for having selected such steps: (1) all of them are powers of
$2$, simulating a
\href{https://en.wikipedia.org/wiki/Bit_plane}{bit-plane} encoding
(this can be interesting to compare with codecs that compresses the
data by bit-planes), and (2) when the number of bit-planes is small,
and we use steps that are not powers of two, the RD curves can have
points for bit-rates $i$ and $i+1$ where the condition
$\lambda_i\ge\lambda_{i+1}$ (being $\lambda_i$ the slope of the RD
curve at the bit-rate $i$) is not satisfied, which difficults the
bit-rate control.} Notice that, since the quantization step sizes are
predetermined, no rate or distortion
control~\cite{vruiz__information_theory} has been incorporated into
the compressor.\footnote{When a codec provides RD control, in general
this implies that we are able to select the output bit-rate and/or the
output quality.}

\section{What do I have to do?}
\begin{enumerate}
\item \textbf{Implement a rate control:} Extend (modify) one of the
  previous notebooks to incorporate a (bit-)rate control
  procedure. Such algorithm should be able to find, given a maximum
  bit-rate $R^\text{max}$, the quantization step (size) $\Delta^*$
  that minimizes the distortion (in terms of the
  \href{https://en.wikipedia.org/wiki/Root-mean-square_deviation}{RMSE
    (Root Mean Square Error)}, see the notebooks).
\end{enumerate}

\section{Timming}
Please, finish this milestone before the day of the ``exam''.

\section{Deliverables}
The modified notebook.

\section{Resources}
\renewcommand{\addcontentsline}[3]{} % Remove functionality of \addcontentsline
\bibliography{data-compression,signal-processing,DWT,image-processing,quantization,information_theory,image-formats}

%%%%%%%%%%%

\begin{comment}
\section{Distortion control}
We do not provide any accurate distortion control algorithm. Our
compressor is able to control the number of gray tones in the
reconstructed image, using a deadzone scalar quantizer. The
quantization steps are selected simulating a
\href{https://en.wikipedia.org/wiki/Bit_plane}{bit-plane}
encoding. Therefore, for 8-bit images, the quantization steps are
$\Delta\in\{128, 64, 32, 16, 8, 4, 2, 1\}$ (powers of $2$). Notice
that we cannot control the distortion in terms of the RMSE, for
example.

\section{Rate control}
The bit-rate (the number of bits/pixel) obtained after using
scalar quantization quantization and PNG depends on:
\begin{enumerate}
\item The number of output indexes generated by the quantizer.
\item The capability of PNG for removing spatial/statistical
  redudancy, aspect that we cannot control with accuracy (only some
  levels of compression are usually available).
\item In the case of SQ, the quantization step size $\Delta$
  used. Notice that, usually, the higher the $\Delta$, the higher the
  compression ratio, the lower the number of bits/pixel, and the lower
  the quality of the reconstructed image.
\end{enumerate}

Therefore, variying $\Delta$ we should be able to generate a Rate/Distortion (RD)
curve~\cite{vruiz__information_theory}, where the $x$-axis represents the bit-rate (in bit/pixel, for
example) and the $y$-axis represents the distortion (the
\href{https://en.wikipedia.org/wiki/Root-mean-square_deviation}{Root
  Mean Square Error (RMSE)}, for example). However, notice that only seven RD points will be available\footnote{This is a direct consequence of using bit-plane encoding.}, and the rate of each point is not controllable.\footnote{Because we cannot control the bit-rate with PNG.}
\end{comment}
