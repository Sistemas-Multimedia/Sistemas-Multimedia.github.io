<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head> <title>Sistemas Multimedia - Scalar Quantization of Gray-scale Images</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js' type='text/javascript'></script>  
</head><body>
   <div class='maketitle'>
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class='titleHead'><a href='https://sistemas-multimedia.github.io/'>Sistemas Multimedia</a> - Scalar Quantization of
Gray-scale Images</h2>
 <div class='author'><a href='https://cms.ual.es/UAL/personas/persona.htm?id=515256515553484875'><span class='ecrm-1200'>Vicente González Ruiz</span></a> <span class='ecrm-1200'>- </span><a href='https://cms.ual.es/UAL/universidad/departamentos/informatica/index.htm'><span class='ecrm-1200'>Depto Informática</span></a> <span class='ecrm-1200'>- </span><a href='https://www.ual.es'><span class='ecrm-1200'>UAL</span></a></div><br />
<div class='date'><span class='ecrm-1200'>October 1, 2022</span></div>
   </div>
   <h3 class='likesectionHead' id='contents'><a id='x1-1000'></a>Contents</h3>
   <div class='tableofcontents'>
    <span class='sectionToc'>1 <a href='#objective' id='QQ2-1-2'>Objective</a></span>
<br />    <span class='sectionToc'>2 <a href='#uniform-sq-of-grayscale-images' id='QQ2-1-3'>Uniform SQ of gray-scale images</a></span>
<br />    <span class='sectionToc'>3 <a href='#nonuniform-sq-of-grayscale-pixel-intensities' id='QQ2-1-4'>Non-Uniform SQ of gray-scale pixel intensities</a></span>
<br />    <span class='sectionToc'>4 <a href='#comparison' id='QQ2-1-5'>Comparison</a></span>
<br />    <span class='sectionToc'>5 <a href='#rd-optimized-quantizer-design' id='QQ2-1-6'>RD optimized quantizer design</a></span>
<br />    <span class='sectionToc'>6 <a href='#what-do-i-have-to-do' id='QQ2-1-7'>What do I have to do?</a></span>
<br />    <span class='sectionToc'>7 <a href='#timming' id='QQ2-1-8'>Timming</a></span>
<br />    <span class='sectionToc'>8 <a href='#deliverables' id='QQ2-1-9'>Deliverables</a></span>
<br />    <span class='sectionToc'>9 <a href='#resources' id='QQ2-1-10'>Resources</a></span>
   </div>
<!-- l. 9 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='objective'><span class='titlemark'>1   </span> <a id='x1-20001'></a>Objective</h3>
<!-- l. 10 --><p class='noindent'>This task shows how to implement a simple <a href='https://en.wikipedia.org/wiki/Lossy_compression'>lossy</a> <a href='https://en.wikipedia.org/wiki/Grayscale'>gray(-scale) image</a> <a href='https://en.wikipedia.org/wiki/Image_compression'>compressor</a> <span class='cite'>[<a href='#Xvruiz__image_IO'>1</a>]</span>
based on SQ (Scalar Quantization) <span class='cite'>[<a href='#Xvruiz__scalar_quantization'>4</a>, <a href='#Xsayood2017introduction'>5</a>, <a href='#Xvetterli2014foundations'>6</a>]</span> and PNG <span class='cite'>[<a href='#Xvruiz__PNG'>3</a>]</span>. The proposed
compressor basically removes the number of different gray <a href='https://en.wikipedia.org/w/index.php?title=Tone_(color)&amp;redirect=no'>tones</a> in an
image<span class='footnote-mark'><a href='#fn1x0' id='fn1x0-bk'><sup class='textsuperscript'>1</sup></a></span><a id='x1-2001f1'></a>.
Therefore, the main objective of this task is to analyze the impact in the encoding
performance (in terms of the RD (Rate/Distortion) tradeoff <span class='cite'>[<a href='#Xvruiz__information_theory'>2</a>]</span>) when the number of
                                                                  

                                                                  
gray levels in an image is controlled.
</p><!-- l. 31 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='uniform-sq-of-grayscale-images'><span class='titlemark'>2   </span> <a id='x1-30002'></a>Uniform SQ of gray-scale images</h3>
<!-- l. 32 --><p class='noindent'>Uniform Scalar Quantization (USQ) transform each input signal value \(\mathbf {s}_i\) (pixels) in a
quantization index \(\mathbf {k}_i\), without considering the rest of samples, and in general,
without any other information about \(\mathbf {s}\) <span class='cite'>[<a href='#Xvruiz__scalar_quantization'>4</a>]</span>. USQ is the simplest quantization
scheme.
</p><!-- l. 39 --><p class='indent'>   There are several USQ mapping algorithms to convert \(\mathbf {s}\) into \(\mathbf {k}\), but all of
them can be classified into <span class='ecti-1000'>midrise </span>and <span class='ecti-1000'>mitread </span>quantizers. In a midrise
quantizer, the reconstructed signal never is 0, even if the original signal is 0 (see
<a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_midrise.ipynb'>gray_SQ_midrise.ipynb</a>)<span class='footnote-mark'><a href='#fn2x0' id='fn2x0-bk'><sup class='textsuperscript'>2</sup></a></span><a id='x1-3001f2'></a>.
On the contrary, midtread quantizers can generate the output 0 (see
<a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_midtread.ipynb'>gray_SQ_midtread.ipynb</a>), which in general is advantagous for lossy compression,
specially if we use a midtread quantizers with deadzone, centered where the <a href='https://en.wikipedia.org/wiki/Signal-to-noise_ratio'>SNR
(Signal to Noise Ratio)</a> is smaller (see <a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_deadzone.ipynb'>gray_SQ_deadzone.ipynb</a>).
</p><!-- l. 54 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='nonuniform-sq-of-grayscale-pixel-intensities'><span class='titlemark'>3   </span> <a id='x1-40003'></a>Non-Uniform SQ of gray-scale pixel intensities</h3>
<!-- l. 55 --><p class='noindent'>Uniform quantizers are efficient (minimize the distortion) only if the input samples
(gray-scale values of the pixels) are uniformly distributed among the quantization
bins <span class='cite'>[<a href='#Xvruiz__scalar_quantization'>4</a>]</span>. However, when the probability of the samples is not “flat” (or the
number of bins is very small compared to the possible number of input values),
we can use better quantizers. For example, if we know that most of the
samples are small integer values (positive and negative), a quantizer such as
<a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_companded.ipynb'>gray_SQ_companded.ipynb</a> can be more suitable than an uniform one. In general,
when the samples follow a probability distribution that only can be modeled using
the <a href='https://en.wikipedia.org/wiki/Probability_density_function'>PDF (Probability Density Function)</a> of the image, then an efficient USQ is
<a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_LloydMax.ipynb'>gray_SQ_LloydMax.ipynb</a>.
</p><!-- l. 71 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='comparison'><span class='titlemark'>4   </span> <a id='x1-50004'></a>Comparison</h3>
<!-- l. 72 --><p class='noindent'>As you can see (run <a href='https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/compare_quantizers.ipynb'>compare_quantizers.ipynb</a>), the way in which the
signal is quantized affects the RD performance, and this fact holds for all
the quantizers, and in general, the better quantizer is the Lloyd-Max
quantizer because it adapts the QSSs (Quantization Step Sizes) to the
<a href='https://en.wikipedia.org/wiki/Histogram'>histogram</a><span class='footnote-mark'><a href='#fn3x0' id='fn3x0-bk'><sup class='textsuperscript'>3</sup></a></span><a id='x1-5001f3'></a>
                                                                  

                                                                  
of the image. However, notice also that, since the QSSs depend on the pixel
intensities distribution of the image, such distribution or the correspondence between
the quantization indexes and the corresponding representation levels (the “pallete”)
must be also “transmitted” to the decoder, which decreases the final RD
performance.
</p><!-- l. 87 --><p class='indent'>   ——– Notice also the remarkable perormance of the DeadZone Quantizer (DZQ)
at low bit-rates. This is one of the reasons why the DZQ is used in several standard
image and video codecs (such as JPEG 2000 and H.264). Another reason is that,
when the QSSs are powers of two, we can use an <a href='https://en.wikipedia.org/wiki/Bit_plane'>bit-plane</a>-based entropy encoder.
———–
</p><!-- l. 95 --><p class='indent'>   Finally, notice that (you must see the notebooks) when the QSSs are
powers of 2, the points of the RD curve tend to belong to the convex hull of
the RD curve. On the contrary, if the QSSs can be any, the RD curves can
have points for bit-rates \(i\) and \(i+1\) where the condition \(\lambda _i\ge \lambda _{i+1}\) (being \(\lambda _i\) the slope of the
RD curve at the bit-rate \(i\)) is not satisfied, which can difficult the (bit-)rate
control.
</p><!-- l. 103 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='rd-optimized-quantizer-design'><span class='titlemark'>5   </span> <a id='x1-60005'></a>RD optimized quantizer design</h3>
<!-- l. 104 --><p class='noindent'>So far, we have designed the image compressor in two steps: (1) quantize the pixels
trying to minimize the distortion, and (2) entropy code (compress) the quantization
indexes. However, if we assume that the entropy encoding performance is
proportional to some rate-prediction metric, such as the entropy, it is possible to
design the quantizer minizing the two RD variables (rate and distortion) at the same
time <span class='cite'>[<a href='#Xsayood2017introduction'>5</a>]</span>. However, there is not (yet) any known reason to think that is approach will
be generate better RD curves that the one in both parameters (R and D) are
minimized independently. Besides, the joint optimization of R and D makes the
quantizer dependent of the entropy codec, that reduces the flexility of the encoding
system.
</p><!-- l. 117 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='what-do-i-have-to-do'><span class='titlemark'>6   </span> <a id='x1-70006'></a>What do I have to do?</h3>
<!-- l. 118 --><p class='noindent'>
     </p><ol class='enumerate1'>
<li class='enumerate' id='x1-7002x1'><span class='ecbx-1000'>Implement  a  rate  control:  </span>Extend  (modify)  one  of  the  previous
     notebooks to incorporate a rate control procedure. Such algorithm should
     be able to find, given a maximum bit-rate \(R^\text {max}\), the QSS \(\Delta ^*\) that minimizes
                                                                  

                                                                  
     the distortion (in terms of the <a href='https://en.wikipedia.org/wiki/Root-mean-square_deviation'>RMSE (Root Mean Square Error)</a>, see the
     notebooks).</li></ol>
<!-- l. 128 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='timming'><span class='titlemark'>7   </span> <a id='x1-80007'></a>Timming</h3>
<!-- l. 129 --><p class='noindent'>Please, finish this milestone before the day of the “exam”.
</p><!-- l. 131 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='deliverables'><span class='titlemark'>8   </span> <a id='x1-90008'></a>Deliverables</h3>
<!-- l. 132 --><p class='noindent'>A notebook.
</p><!-- l. 134 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='resources'><span class='titlemark'>9   </span> <a id='x1-100009'></a>Resources</h3>
   <div class='thebibliography'>
   <p class='bibitem'><span class='biblabel'>
 [1]<span class='bibsp'>   </span></span><a id='Xvruiz__image_IO'></a>V. González-Ruiz. <a href='https://vicente-gonzalez-ruiz.github.io/image_IO/'>Image IO</a>.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [2]<span class='bibsp'>   </span></span><a id='Xvruiz__information_theory'></a>V. González-Ruiz. <a href='https://vicente-gonzalez-ruiz.github.io/information_theory/'>Information Theory</a>.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [3]<span class='bibsp'>   </span></span><a id='Xvruiz__PNG'></a>V. González-Ruiz. <a href='https://vicente-gonzalez-ruiz.github.io/PNG/'>PNG (Portable Network Graphics)</a>.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [4]<span class='bibsp'>   </span></span><a id='Xvruiz__scalar_quantization'></a>V. González-Ruiz. <a href='https://vicente-gonzalez-ruiz.github.io/scalar_quantization/'>Scalar Quantization</a>.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [5]<span class='bibsp'>   </span></span><a id='Xsayood2017introduction'></a>K. Sayood.   <a href='http://rahilshaikh.weebly.com/uploads/1/1/6/3/11635894/data_compression.pdf'><span class='ecti-1000'>Introduction to Data Compression</span></a>.   Morgan  Kaufmann,
   2017.
                                                                  

                                                                  
   </p>
   <p class='bibitem'><span class='biblabel'>
 [6]<span class='bibsp'>   </span></span><a id='Xvetterli2014foundations'></a>M. Vetterli, J. Kovačević, and V.K. Goyal.  <a href='http://www.fourierandwavelets.org/FSP_v1.1_2014.pdf'><span class='ecti-1000'>Foundations of Signal
   </span><span class='ecti-1000'>Processing</span></a>. Cambridge University Press, 2014.
</p>
   </div>
   <div class='footnotes'><!-- l. 22 --><p class='indent'>     <span class='footnote-mark'><a href='#fn1x0-bk' id='fn1x0'><sup class='textsuperscript'>1</sup></a></span><span class='ecrm-0800'>Normally, </span><a href='https://en.wikipedia.org/wiki/Visual_system'><span class='ecrm-0800'>humans</span></a> <span class='ecrm-0800'>hardly distinguish more than 64 different </span><a href='https://en.wikipedia.org/wiki/Color'><span class='ecrm-0800'>colors</span></a></p>
<!-- l. 45 --><p class='indent'>     <span class='footnote-mark'><a href='#fn2x0-bk' id='fn2x0'><sup class='textsuperscript'>2</sup></a></span><span class='ecrm-0800'>In a midrise quantizer, if</span> \(\mathbf {s}_i=0\)<span class='ecrm-0800'>, then</span> \(\mathbf {y}_i=\Delta \) <span class='ecrm-0800'>or</span> \(\mathbf {y}_i=-\Delta \)<span class='ecrm-0800'>.</span></p>
<!-- l. 80 --><p class='indent'>     <span class='footnote-mark'><a href='#fn3x0-bk' id='fn3x0'><sup class='textsuperscript'>3</sup></a></span><span class='ecrm-0800'>Or </span><a href='https://en.wikipedia.org/wiki/Probability_density_function'><span class='ecrm-0800'>PDF (Probability Density Function)</span></a> <span class='ecrm-0800'>in the case of a continuous signal.</span></p>             </div>
 
</body> 
</html>