<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head> <title>Sistemas Multimedia - Study Guide - Milestone 10: IPP... Coding in the Image
Domain</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js' type='text/javascript'></script>  
</head><body>
   <div class='maketitle'>
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class='titleHead'><a href='https://sistemas-multimedia.github.io/'>Sistemas Multimedia</a> - Study Guide - Milestone
10: IPP... Coding in the Image Domain</h2>
 <div class='author'><a href='https://cms.ual.es/UAL/personas/persona.htm?id=515256515553484875'><span class='ecrm-1200'>Vicente González Ruiz</span></a> <span class='ecrm-1200'>- </span><a href='https://cms.ual.es/UAL/universidad/departamentos/informatica/index.htm'><span class='ecrm-1200'>Depto Informática</span></a> <span class='ecrm-1200'>- </span><a href='https://www.ual.es'><span class='ecrm-1200'>UAL</span></a></div><br />
<div class='date'><span class='ecrm-1200'>July 9, 2022</span></div>
   </div>
   <h3 class='likesectionHead' id='contents'><a id='x1-1000'></a>Contents</h3>
   <div class='tableofcontents'>
    <span class='sectionToc'>1 <a href='#description' id='QQ2-1-2'>Description</a></span>
<br />     <span class='subsectionToc'>1.1 <a href='#intra-i-video-coding' id='QQ2-1-3'>Intra (I) video coding</a></span>
<br />     <span class='subsectionToc'>1.2 <a href='#motion-compensation-prediction-p-video-coding' id='QQ2-1-5'>Motion compensation prediction (P) video coding</a></span>
<br />     <span class='subsectionToc'>1.3 <a href='#types-of-macroblocks' id='QQ2-1-6'>Types of macro-blocks</a></span>
<br />     <span class='subsectionToc'>1.4 <a href='#macroblock-type-decision' id='QQ2-1-8'>Macro-block type decision</a></span>
<br />     <span class='subsectionToc'>1.5 <a href='#codec' id='QQ2-1-9'>Codec</a></span>
<br />    <span class='sectionToc'>2 <a href='#what-do-i-have-to-do' id='QQ2-1-11'>What do I have to do?</a></span>
<br />    <span class='sectionToc'>3 <a href='#timming' id='QQ2-1-12'>Timming</a></span>
<br />    <span class='sectionToc'>4 <a href='#deliverables' id='QQ2-1-13'>Deliverables</a></span>
<br />    <span class='sectionToc'>5 <a href='#resources' id='QQ2-1-14'>Resources</a></span>
   </div>
<!-- l. 8 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='description'><span class='titlemark'>1   </span> <a id='x1-20001'></a>Description</h3>
<!-- l. 10 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='intra-i-video-coding'><span class='titlemark'>1.1   </span> <a id='x1-30001.1'></a>Intra (I) video coding</h4>
                                                                  

                                                                  
<!-- l. 12 --><p class='noindent'>In the III... (or Intra video) coding, the <a href='https://sistemas-multimedia.github.io/milestones/07-DCT/'>2D block-DWT</a>, the <a href='https://sistemas-multimedia.github.io/milestones/08-DWT/'>2D DWT</a>, or
any other spatial transform, is used on sequences of frames (images)
to exploit the spatial correlation. This is achieved by simply iterating the
spatial decorrelation as it is described in the Algorithm <a href='#x1-3002r1'>1<!-- tex4ht:ref: alg:III_coding  --></a> <span class='cite'>[<a href='#Xtaubman2002jpeg2000'>1</a>]</span>, where \(V\) in
the input sequence and \(S\) controls the number of SRLs (Spatial Resolution
Levels)<span class='footnote-mark'><a href='#fn1x0' id='fn1x0-bk'><sup class='textsuperscript'>1</sup></a></span><a id='x1-3001f1'></a>.
The synthesis transform is computed using the Algorithm <a href='#x1-3009r2'>2<!-- tex4ht:ref: alg:III_decoding  --></a>. In the Fig. <a href='#x1-3016r1'>1<!-- tex4ht:ref: fig:III  --></a>
there is an example of the decomposition generated for three frames \(V_0\), \(V_1\) and
\(V_2\).
<a id='x1-3002r1'></a>
</p><!-- l. 27 --><p class='indent'>   <span class='ecbx-1000'>Algorithm 1</span>: III-coding(\(\mathbf {V}\) /* original video sequence */, \(S\) /* Number of extra
levels */) \(\rightarrow \) (\(\mathbf {O}\) /* transformed video sequence */)<br class='newline' />
     </p><ol class='enumerate1'>
<li class='enumerate' id='x1-3004x1'>\({\mathbf O}=\{\}\) /* empty sequence */.
     </li>
<li class='enumerate' id='x1-3006x2'>
     <!-- l. 31 --><p class='noindent'>for \({\mathbf V}_i\in {\mathbf V}\):
         </p><ol class='enumerate2'>
<li class='enumerate' id='x1-3008x1'>\({\mathbf O}_i\leftarrow \text {2D-T}^{S}({\mathbf V}_i)\) /* 2D analysis spatial transform */.</li></ol>
     </li></ol>
<p><a id='x1-3009r2'></a>
</p><!-- l. 38 --><p class='indent'>   <span class='ecbx-1000'>Algorithm 2</span>: III-decoding(\(\mathbf {O}\) /* transformed video sequence */, \(S\) /* Number of
extra levels */) \(\rightarrow \) (\(\mathbf {V}\) /* original video sequence */)<br class='newline' />
     </p><ol class='enumerate1'>
<li class='enumerate' id='x1-3011x1'>\({\mathbf V}=\{\}\) /* empty sequence */.
     </li>
<li class='enumerate' id='x1-3013x2'>
     <!-- l. 42 --><p class='noindent'>for \({\mathbf O}_i\in {\mathbf O}\):
                                                                  

                                                                  
         </p><ol class='enumerate2'>
<li class='enumerate' id='x1-3015x1'>\({\mathbf V}_i\leftarrow \text {2D-T}^{-S}({\mathbf O}_i)\) /* 2D synthesis spatial transform */.</li></ol>
     </li></ol>
   <figure class='figure'> 

                                                                  

                                                                  
                                                                  

                                                                  
<!-- l. 51 --><p class='noindent' id='-decomposition-generated-by-levels-s-ddwt-and-the-xdct-block-size-is-equal-to-s-'><div style='text-align:center;'> <img src='graphics/forward_MDWT.svg' /> </div>  <a id='x1-3016r1'></a>
<a id='x1-3017'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 1: </span><span class='content'>Decomposition generated by 1-levels (\(S=1\)) 2D-DWT and the 2x2-DCT
(block size is equal to \(S+1\)).                                              </span></figcaption><!-- tex4ht:label?: x1-3016r1  -->
                                                                  

                                                                  
   </figure>
   <h4 class='subsectionHead' id='motion-compensation-prediction-p-video-coding'><span class='titlemark'>1.2   </span> <a id='x1-40001.2'></a>Motion compensation prediction (P) video coding</h4>
<!-- l. 57 --><p class='noindent'>III... video coding is fast and good for video edition, but the compression ratios are
poor because the temporal correlation is not removed. IPP... video coding (also called
inter-coding) uses MC (Motion Compensation) to exploit the temporal correlation
in frame sequences. IPP... encoders split the sequence into <a href='https://en.wikipedia.org/wiki/Group_of_pictures'>GOPs (Groups
of Frames)</a>, where the first frame of each GOP is a I-type frame, and the
rest of frames of the GOP are P-type. P-frames are motion-compensated
frames and usually the reference frame is the previous one, in the temporal
order.
</p><!-- l. 68 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='types-of-macroblocks'><span class='titlemark'>1.3   </span> <a id='x1-50001.3'></a>Types of macro-blocks</h4>
<!-- l. 69 --><p class='noindent'>A P-type frame is created in two steps:
     </p><ol class='enumerate1'>
<li class='enumerate' id='x1-5002x1'>The frame is divided into non-overlapping blocks (typically of \(16\times 16\) pixels),
     that in this context we will call, macro-blocks.
     </li>
<li class='enumerate' id='x1-5004x2'>A prediction frame is generated using a field of motion vectors (one vector
     per matro-block) and a reference.
     </li>
<li class='enumerate' id='x1-5006x3'>The prediction frame is substracted to the predicted frame, generating a
     prediction-error frame.</li></ol>
<!-- l. 79 --><p class='noindent'>In general, most of the time this procedure success in temporally decorrelate the frames.
However, it can also happen that when the reference(s) frame(s) is very different from
the predicted one, the prediction-error frame has a higher entropy than the original
(predicted) one.
</p><!-- l. 85 --><p class='indent'>   In order to minimize this inconvenient, most video coding standards use the
following types of macro-blocks:
     </p><ol class='enumerate1'>
                                                                  

                                                                  
<li class='enumerate' id='x1-5008x1'>I (intra): if the macro-block is not compensated.
     </li>
<li class='enumerate' id='x1-5010x2'>P (predicted): if the macro-blocks is compensated.
     </li>
<li class='enumerate' id='x1-5012x3'>B (bidirectionally predicted): if the macro-block is compensated using an
     anterior and a posterior frame.
     </li>
<li class='enumerate' id='x1-5014x4'>S  (skipped):  if  the  macro-block  is  substituted  by  reference  one  (no
     substraction is performed).</li></ol>
<!-- l. 95 --><p class='noindent'>The decision of the type of each macro-block is performed at the compressor, and this
information is signaled in the code-stream. An visual example of the decision of the
type of the macro-blocks is shown in the Figure <a href='#x1-5015r2'>2<!-- tex4ht:ref: fig:macroblocks  --></a>.
</p>
   <figure class='figure'> 

                                                                  

                                                                  
                                                                  

                                                                  
<!-- l. 102 --><p class='noindent' id='-types-of-macroblocks-'><div style='text-align:center;'> <img src='graphics/macroblocks.svg' /> </div>  <a id='x1-5015r2'></a>
<a id='x1-5016'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 2: </span><span class='content'>Types of macro-blocks.                                      </span></figcaption><!-- tex4ht:label?: x1-5015r1  -->
                                                                  

                                                                  
   </figure>
   <h4 class='subsectionHead' id='macroblock-type-decision'><span class='titlemark'>1.4   </span> <a id='x1-60001.4'></a>Macro-block type decision</h4>
<!-- l. 108 --><p class='noindent'>Ideally, the type (also called, mode) of the macro-blocks is decided considering all the
posibilities (I, P, B, or S) and selecting the most beneficial one from a RD perpective,
i.e., selecting the alternative that minimizes the RD cost. This RDO is performed at
the macro-block level.
</p><!-- l. 114 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='codec'><span class='titlemark'>1.5   </span> <a id='x1-70001.5'></a>Codec</h4>
   <figure class='figure'> 

                                                                  

                                                                  
                                                                  

                                                                  
<!-- l. 117 --><p class='noindent' id='-a-interintra-video-codec-'><div style='text-align:center;'> <img src='graphics/codec.svg' /> </div>  <a id='x1-7001r3'></a>
<a id='x1-7002'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 3: </span><span class='content'>A inter/intra video codec.                                    </span></figcaption><!-- tex4ht:label?: x1-7001r1  -->
                                                                  

                                                                  
   </figure>
<!-- l. 122 --><p class='indent'>   The Figure <a href='#x1-7001r3'>3<!-- tex4ht:ref: fig:IPP_codec  --></a> describes an inter/intra video codec, that corresponds
to:
</p><!-- l. 128 --><p class='indent'>   \begin {equation}  {\mathbf W}_k = \text {color-T}({\mathbf V}_k), \tag {a}  \end {equation}

</p><!-- l. 133 --><p class='indent'>   \begin {equation}  {\mathbf W}_{k-1} = Z^{-1}({\mathbf W}, k-1), \tag {b}  \end {equation}
and by definition, \(Z^{-1}({\mathbf W}, -1) = {\mathbf 0}\),
</p><!-- l. 139 --><p class='indent'>   \begin {equation}  \overset {(k-1)\rightarrow k}{\mathbf M} = \text {ME}({\mathbf W}_{k-1}, {\mathbf W}_k), \tag {c}  \end {equation}
where ME stands for Motion Estimation, and by definition, \(\overset {(-1)\rightarrow 0}{{\mathbf M}} = {\mathbf 0}\),
</p><!-- l. 146 --><p class='indent'>   \begin {equation}  \overset {(k-1)\rightarrow k}{\mathbf M} = \overset {(k-1)\rightarrow k}{\mathbf M} \text {(lossless~coding)}, \tag {d}  \end {equation}

</p><!-- l. 151 --><p class='indent'>   \begin {equation}  \overset {(k-1)\rightarrow k}{\mathbf M} = \overset {(k-1)\rightarrow k}{\mathbf M} \text {(lossless~decoding)}, \tag {e}  \end {equation}

</p><!-- l. 156 --><p class='indent'>   \begin {equation}  {\mathbf E}_k = {\mathbf W}_k - \overset {\wedge }{{\mathbf W}}_k, \tag {f}  \end {equation}
where the symbol \(-\) represents to the pixel-wise substraction,
</p><!-- l. 162 --><p class='indent'>   \begin {equation}  \overset {\sim }{{\mathbf E}_k} = \text {QE}({\mathbf E}_k), \tag {g}  \end {equation}
where QE\((\cdot )\) represents the lossy compression of the prediction error texture
data,
</p><!-- l. 169 --><p class='indent'>   \begin {equation}  \overset {\sim }{\mathbf E}_k = \text {DQ}^{-1}(\overset {\sim }{\mathbf E}_k), \tag {h}  \end {equation}
where DQ\(^{-1}(\cdot )\) represents the decompression of the prediction error texture data,
</p><!-- l. 176 --><p class='indent'>   \begin {equation}  \overset {\sim }{\mathbf W}_k \leftarrow \overset {\sim }{\mathbf E}_k + \overset {\wedge }{\mathbf W}_k, \tag {i}  \end {equation}
and notice that if \(\overset {\wedge }{\mathbf W}_k = {\mathbf 0}\), then \(\overset {\sim }{\mathbf E}_k = \overset {\sim }{\mathbf W}_k\),
</p><!-- l. 183 --><p class='indent'>   \begin {equation}  \overset {\wedge }{\mathbf W}_k = \text {P}(\overset {\sim }{\mathbf W}_{k-1}, \overset {(k-1)\rightarrow k}{\mathbf M}), \tag {j}  \end {equation}
where P\((\cdot ,\cdot )\) is a motion compensated predictor, and
</p><!-- l. 189 --><p class='indent'>   \begin {equation}  \overset {\wedge }{\mathbf W}_{k-1} = Z^{-1}(\overset {\wedge }{\mathbf W}, k-1), \tag {k}  \end {equation}
where by definition, \(Z^{-1}(\overset {\wedge }{\mathbf W}, -1) = 0\), and
</p><!-- l. 195 --><p class='indent'>   \begin {equation}  {\mathbf V} = \text {color-T}^{-1}({\mathbf W}_k), \tag {l}  \end {equation}
is the inverse color transform.
</p><!-- l. 198 --><p class='indent'>   Notice that if \(\overset {\wedge }{{\mathbf W}}_k\) is similar to \({\mathbf W}_k\), then \({\mathbf E}_k\) will be approximately zero, and therefore,
easely compressed. Another interesting aspect to highlight is that the encoder
replicates de decoder in order to use the reconstructed images as reference and avoid
the drift error.
</p>
   <h3 class='sectionHead' id='what-do-i-have-to-do'><span class='titlemark'>2   </span> <a id='x1-80002'></a>What do I have to do?</h3>
<!-- l. 206 --><p class='noindent'>In groups, implement the coded of the Figure <a href='#x1-7001r3'>3<!-- tex4ht:ref: fig:IPP_codec  --></a>. Use the code available at <a href='https://github.com/Sistemas-Multimedia/MRVC'>the MRVC
project</a>.
</p><!-- l. 210 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='timming'><span class='titlemark'>3   </span> <a id='x1-90003'></a>Timming</h3>
<!-- l. 212 --><p class='noindent'>Present your results the day of the exam.
                                                                  

                                                                  
</p><!-- l. 214 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='deliverables'><span class='titlemark'>4   </span> <a id='x1-100004'></a>Deliverables</h3>
<!-- l. 216 --><p class='noindent'>The code of the implementation and a presentation of the work and how the codec
works.
</p><!-- l. 218 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='resources'><span class='titlemark'>5   </span> <a id='x1-110005'></a>Resources</h3>
   <div class='thebibliography'>
   <p class='bibitem'><span class='biblabel'>
 [1]<span class='bibsp'>   </span></span><a id='Xtaubman2002jpeg2000'></a>D.S. Taubman and W.M. Marcellin.   <a href='https://last.hit.bme.hu/download/firtha/video/JPEG2000/David%20S.%20Taubman,%20%20Michael%20W.%20Marcellin%20%20(auth.)%20JPEG2000%20Image%20Compression%20Fundamentals,%20Standards%20and%20Practice%20%202002.pdf'><span class='ecti-1000'>JPEG2000. Image Compression
   </span><span class='ecti-1000'>Fundamentals, Standards and Practice</span></a>. Kluwer Academic Publishers, 2002.
</p>
   </div>
   <div class='footnotes'><!-- l. 22 --><p class='indent'>     <span class='footnote-mark'><a href='#fn1x0-bk' id='fn1x0'><sup class='textsuperscript'>1</sup></a></span><span class='ecrm-0800'>Notice that at least one SRL is always available for each image or video sequence</span></p>    </div>
 
</body> 
</html>