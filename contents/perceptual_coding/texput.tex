% Emacs, this is -*-latex-*-

\input{../../definitions}
\title{\SM{} - Perceptual Coding}

\maketitle
\tableofcontents

\section{What is perceptual coding?}

So far, we have been focused on minimizing the lagrangian~\cite{sullivan1998rate}
\begin{equation}
  J = R + \lambda D,
\end{equation}
where $D$ is a additive\footnote{The total distortion of two (or more)
sources of distortion is the sum of the distortions of these two (or
more) sources.} distance metric, such as the RMSE, the PSNR or SSIM
index~\cite{wang2004image}. However, the way in which human beings
perceive distortion is generally different from how these metrics
express it. This chapter presents some of the most common ways of
expressing the distortion perceived by humans.

Notice that if, by requirements of the encoding process, $D$ is below
a threshold of noticeable distortion, the RDO process boilds down to
select the option with smaller $R$.

\section{Perception of the details (high frequencies)}
The HVS can be modeled as a low-pass filter whose cut-off frequency
depends on the distance between the observer and the image.

Some image and video coding standards, such as JPEG and H.264 specify
quantization matrices designed to perceptual coding. In the case of
video, such matrices can change between images. Usually, luma and
chroma have different quantization
matrices~\cite{naccari2014perceptually}.

\section{Visual masking phenomena and the quantization noise}
Deadzone quantization: change signal and electronic noise by
quantization noise, where the SNR is very small.

HVS is less sensitive to coding artifacts introduced in textured and
very busy image areas~\cite{wu2017digital}. In general, the perceived
quantization error decreases with the increase of the frequency of the
signal, up to a point in which the image contents mask the noise,
which can become imperceptible.

directionality: which leads the HVS to be more sensitive to
distortions added to horizontal and vertical frequencies rather than
to diagonal ones~\cite{naccari2014perceptually}.

Weber-Fechner law which states
that the minimum perceivable visual stimulus difference increases with the background luminance.

The rationale behind the temporal masking is that the HVS sensitivity
to coding artifacts is lower in areas with very high motion
activity. Modeling temporal masking is more challenging because the
spatio-temporal sensitivity function of the HVS is not separable
([12,31]), i.e., it depends on both the spatial and temporal
frequencies~\cite{naccari2014perceptually}.

\section{Loop filters}
Use for example in H.264 In-loop filters aim to improve the perceived
video quality by reducing coding artifacts. The filter acts to reduce
the blocking artifacts while preserving original image edges.


\section{Quantization in the $\texttt{RGB}$ domain}

The color-recognition accuracy of the HVS is
finite~\cite{vruiz__visual_redundancy}. For this reason, quantization
in the $\texttt{RGB}$ color space can be imperceptible.

any alternative different from
\begin{equation}
  \mathbf{\Delta}^{\text{R}}_i = \mathbf{\Delta}^{\text{G}}_i =
  \mathbf{\Delta}^{\text{B}}_i,
  \label{eq:simple_Q}
\end{equation}
where $i$ represents the $i$-th quantization step size, will produce
some alteration in the color\footnote{We consider here color as a
whole, not only the chroma.}

\section{Chroma redundancy}

Humans do not perceive detail in the chrominance as well as in they
does in the
luminance.~\cite{burger2016digital}. As in
$\text{YCrCb}$, the
\href{https://en.wikipedia.org/wiki/Sampling_(signal_processing)}{sampling
  rate} of the chroma is usually reduces to 1/4 without any noticeable
distortion. This feature is used in some of the last image and video
compression systems such as
\href{https://en.wikipedia.org/wiki/JPEG_XR#Description}{JPEG XR} and
\href{https://en.wikipedia.org/wiki/High_Efficiency_Video_Coding#Video_coding_layer}{HEVC}.

See the notebook
\href{https://github.com/vicente-gonzalez-ruiz/color_transforms/blob/main/docs/color_redundancy.ipynb}{Spectral
  (color) redundancy}.

\section{Redundancy in the RGB domain}

The Human Visual System (HVS) is more sensitive to luminance than to
chrominance~\cite{vruiz__visual_redundancy}. This basically means that
we can an encoding process we modify the color information of an image
or a video without noticing a high distortion.

Since the \href{https://en.wikipedia.org/wiki/Visual_system}{HVS
  (Human Visual System)} is not able to perceive detail in the
chrominance as well as it does in the luminance, the amount of
information, and consequently
\href{https://en.wikipedia.org/wiki/Sampling_(signal_processing)}{sampling
  rate}, used in the chrominance can be generally reduced to 1/4 of
the used for the luminance without a noticeable distortion (see
Fig.~\ref{fig:san-diego_chroma_subsampled})~\cite{burger2016digital}. This
\href{https://en.wikipedia.org/wiki/Bandwidth_(computing)}{fact is
  used when compressing} digital still images and is one of the reason
why, for example, the $\text{YCrCb}$ transform is used in the
\href{https://en.wikipedia.org/wiki/JPEG}{JPEG} image compressor.

%  V E R   R E P O   V I S U A L   R E D U N D A N C Y

\begin{figure}
  \centering
  \png{san-diego_chroma_subsampled}{1000}
  \caption{Visual effect of chroma subsamplig in the YCrCb domain. See
    this
    \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/milestones/06-YUV_compression/chroma_subsampling.ipynb}{notebook}.}
  \label{fig:san-diego_chroma_subsampled}
\end{figure}

\section{Perceptual video coding}
Hummans perceive distortion generated by the (lossy) compression
artifacts depending on the characteristics of the sequence. Therefore,
we can apply a coarser compression to image areas where the human
visual system is less sensitive to artifacts and a finer compression
otherwise.

\section{To-Do}
Please, select one of the following tasks to develop:
\begin{enumerate}
\item
\end{enumerate}

\section{References}

\renewcommand{\addcontentsline}[3]{}% Remove functionality of \addcontentsline
\bibliography{quantization,video_compression,rate_control}
