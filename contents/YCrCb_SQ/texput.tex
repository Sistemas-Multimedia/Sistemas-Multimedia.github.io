% Emacs, this is -*-latex-*-

\input{../../definitions} \title{\SM{} - Study Guide - Image
  Compression using the $\text{YCrCb}$ Color Transform}

\maketitle
\tableofcontents

\section{Objective}
Let's use the
\href{https://en.wikipedia.org/wiki/YCbCr}{$\text{YCrCb}$} color (from
the \text{RGB} domain) transform to exploit the color redundancy of
$\text{RGB}$ images~\cite{vruiz__visual_redundancy}. 

\section{The $\text{YCrCb}$ color domain}
$\text{YCrCb}$ is a \emph{luma}-based
(luminance-based\footnote{Luminance can be considered as the intensity
part of a viual stimuli.} color domain. This domain rely on the idea
of separating the luminance coefficients (Y) from two \emph{chroma}
coefficients (red and blue in the case of $\text{YCrCb}$). After using
the transform, most of the energy will be concentrated in the luma
($\text{Y}$) subband.

The $\text{YCrCb}$ color model can be considered the digital version
of the \href{https://en.wikipedia.org/wiki/YUV}{$\text{YUV}$ (analog)
  color model}, and in some way can be used to maintain the
compatibility with legacy black and white systems is maintained while
at the same time the bandwidth of the signal can be optimized by using
diï¬€erent transmission bandwidths for the brightness and the chroma
components.\footnote{Notice, however, that in the digital world
bandwidth savings are equivalent to reduce the sampling
rate.}~\cite{burger2016digital}

\section{Chroma redundancy}

Humans do not perceive detail in the chrominance as well as in they
does in the
luminance.~\cite{vruiz__visual_redundancy,burger2016digital}. Consecuently,
the
\href{https://en.wikipedia.org/wiki/Sampling_(signal_processing)}{sampling
  rate} used in the chrominance can be generally reduced to 1/4 of the
used for the luminance without a noticeable distortion (see
Fig.~\ref{fig:san-diego_chroma_subsampled}). This
\href{https://en.wikipedia.org/wiki/Bandwidth_(computing)}{fact is
  used when compressing} digital still images and is one of the reason
why, for example, the \href{https://en.wikipedia.org/wiki/JPEG}{JPEG}
image compressor converts $\text{RGB}$ images to
$\text{YCrCb}$. However, notice that we will explore this posibility
in a different task.

\section{Quantization in the $\text{YCrCb}$ domain}
%{{{ 
The YCrCb transform is not orthogonal and the relative synthesis
filters gains depends on the energy of the inversely transformed
components. In this case, we can estimate the distortion generated by
the quantization of a color subband, always measured in the RGB
domain, if the rest of subbands are unquantized. This can be the
algorithm:
\begin{enumerate}
\item Variying the $\Delta$, estimate the RD curve for each YCrCb
  subband, keeping the other subbands unquantized. The distortion must
  be measures in the RGB domain.
\item Sort the RD points by their slope.
\item Apply progressively the combinations quantization steps. The
  distortion can be measure in both, the color-DCT and the RGB
  domains.
\end{enumerate}
See this \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/06-color_transform/YCrCb_compression.ipynb}{notebook}.

Notice that the only alternative to this ``fast'' rate-control
algorithm is to perform a brute-force search of quantization steps
combinations.

The synthesis filters gains are important because the quantization
steps of each YCrCb component should be adjusted in order to
effectively provide the desired number of
\href{http://www.winlab.rutgers.edu/~crose/322_html/quantization.pdf}{bins}
(different dequantized values) in each component.

The synthesis filters generates a gain of $||1^2 + 1^2 + 1^2||_2^2=3$
(square of the Euclidean norm) for the $\text{Y}$ component,
$||1.402^2 + 0.714^2 + 0^2||_2^2=2.4754$ for the $\text{Cr}$
component, and $||0^2 + 0.344^2+ 1.772^2||_2^2=3.25832$ for the
$\text{Cb}$ component. So, when compressing an image through
quantization, the QSs should be modulated accordinly (the higher the
gain, the higher the quantization error, and therefore, the smaller
the QS should be).

The RGB/YCrCb
transform is not orthogonal\footnote{The RGB/YCrCb is not orthogonal
because, for example, as we can see in the
Eq.~\ref{eq:YCrCb_analysis}, the value of Cr depends on the value of
Y, and therefore, there is a dependency between both
\href{https://en.wikipedia.org/wiki/Basis_(linear_algebra)}{basis}.}
and therefore the contribution of each channel to the quality of the
reconstructed image $\tilde{X}$ are not additive (this can be seen in
this
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/06-color_transform/performance.ipynb}{notebook}).

%}}}

\section{What do I have to do?}

\begin{enumerate}
\item Please, run the previous
  \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/06-color_transform/performance.ipynb}{notebook}
  to learn some insights about the problem of the optimal
  quantization in the color domain.
\item Include in the previous
  \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/06-color_transform/performance.ipynb}{notebook}
  an implementation of the
  \href{https://en.wikipedia.org/wiki/JPEG_2000#Color_components_transformation}{RCT
    (Reversible Color Transform)} and compare it's RD performance with
  the other transforms.
\item Implement the transform described in Eq.~\ref{eq:optimal}, and
  compare it with the other transforms.
\end{enumerate}

\subsection{Rate-control}
%{{{
When the transform is orthogonal, the quantization step of a subband should be inversely proportional to the subband gain.  
%}}}

\section{Timming}

Please, finish this milestone before the next class session.

\section{Deliverables}

None.

\section{Resources}

\renewcommand{\addcontentsline}[3]{}% Remove functionality of \addcontentsline
\bibliography{maths,data-compression,signal-processing,DWT,image-compression,image-processing}
