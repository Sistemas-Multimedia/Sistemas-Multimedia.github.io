% Emacs, this is -*-latex-*-

\input{../../definitions}
\title{Lossy Compression of Gray-scale Images}

\maketitle
\tableofcontents

\section{Description}
%{{{

Gray-Scale (GS) images only have one (color) channel, at it is usually
represented in color displays using gray color tones (the same amount
if red, green and blue components). In most of the cases, the number
of bits per pixel (the depth of the image) is 8, but it is not rare to
use up to 16 bits/pixel~\cite{burger2016digital}. However, it is quite
difficult to find a color display with more than 256 gray colors.

In this milestone we will see how to
\href{https://vicente-gonzalez-ruiz.github.io/quantization/}{quantize}
the image, and then compression the image with PNG, to create a
\href{https://en.wikipedia.org/wiki/Lossy_compression}{lossy image
  compressor}.

\subsection{Scalar and vector quantization of GS images}
%{{{

The compression ratio of our lossy image compressor can be controled
by means of quantization. At this point we have basically two
alternatives:
\begin{enumerate}
\item \textbf{Scalar Quantization (SQ)}: each pixel is quantized
  without considering the rest~\cite{vruiz__scalar_quantization}.
\item \textbf{Vector Quantization (VQ)}: the pixels are quantized
  block-by-block (2D vectors)~\cite{vruiz__vector_quantization}.
\end{enumerate}
Notice that VQ exploits the spatial correlation, but not SQ. For this
reason, we will use PNG after SQ. In the case of VQ, only the
statistical redundancy remains, that can be exploited by any entropy
codec (and obviously, any image codec).

%}}}

\subsection{Bit-rate control}
%{{{

The bit-rate (the number of bits/pixel) obtained after using
quantization + PNG depends on:
\begin{enumerate}
\item The number of outputs generated by the quantizer.
\item The capability of PNG for removing spatial/statistical
  redudancy, aspect that we cannot control with accuracy (only some
  levels of compression are usually available).
\item In the case of SQ, the quantization step size $\Delta$ used. The
  higher the $\Delta$, the higher the compression ratio, the lower the
  number of bits/pixel, and the lower the quality of the reconstructed
  image. For VQ, this effects depends on the ratio between the number
  of different combinations of patters (of a given size) found in the
  image $M$ and the number of vectors $N$ used in the code-book.
\end{enumerate}
Variying $\Delta$ (in the case of SQ) or $N/M$ (in the case of VQ) we
should be able to generate a Rate/Distortion (RD) curve, where the
X-axis represents the bit-rate (in bit/pixe, for example) and the
Y-axis represents the distortion (the
\href{https://en.wikipedia.org/wiki/Root-mean-square_deviation}{Root
  Mean Square Error (RMSE)}, for example).

Normaly, RD curves are convex (see Fig.~\ref{fig:RD_slopes}), which
means that if $\lambda_i$ is the slope of the curve measured at the
$i$-th point of the curve (starting at the lowest bit-rate), it
usually hold that
\begin{equation}
  \lambda_i > \lambda_{i+1}.
  \label{eq:convexity}
\end{equation}
where $\lambda$ quantifies the trade-off between decreasing the
distortion\footnote{For this reason, the slopes are negative.} while
the bit-rate
increases~\cite{vetterli1995wavelets,sayood2017introduction}. However,
Eq.~\ref{eq:convexity} is not always true. This can be seen in the
notebooks \href{}{midtread\_quantization},
\href{midrise\_quantization}, \href{deadzone\_quantization} and
\href{}{companded\_quantization}.

As it can be also seen in the notebook
\href{}{quantizers\_comparison}, the performance of the quantizers is
not the same (usually midrise and midtread, performs better than
deadzone at intermediate bit-rates, but deadzone is the best a low
bit-rates. Deadzone has also another advantage over midread and
midtread: when $\Delta$ is a power of 2 (which corresponds to a
bit-plane encoding), the obtained RD point is near optimal in the RD
space.

%}}}

%}}}

\section{What do I have to do?}
%{{{

\begin{enumerate}
\item Create a notebook named ``bit-rate\_control.ipynb'' that, given
  a maximum bit-rate, finds the quantization step $\Delta^*$ that
  minimizes the distortion. Use the quantizer your prefer.
\end{enumerate}

%}}}

\section{Timming}

Please, finish this milestone before the next class session.

\section{Deliverables}

None.

\section{Resources}

\renewcommand{\addcontentsline}[3]{} % Remove functionality of \addcontentsline
\bibliography{data-compression,signal-processing,DWT,image-processing}
