\input{../definitions}
\title{\SM{} - Study Guide - Milestone 5: Energy Concentration and Multiresolution  with the Discrete Wavelet Transform}

\maketitle

\section{Description}

\subsection{Transform coding}

\href{https://web.stanford.edu/class/ee398a/handouts/lectures/07-TransformCoding.pdf}{Transform
  coding} can exploit
\href{https://en.wikipedia.org/wiki/Correlation_and_dependence}{correlation}
in signals to concentrate the energy. Specifically, the DWT (Discrete
Wavelet Transform) is a family of transforms whose output describes
the (input) signal in a set of subbands. This set is also called a
decomposition and the index of the subband is related to the frequency
of the signal. In the case of the images, the coefficients of the
subbands are related to
\href{https://en.wikipedia.org/wiki/Discrete_wavelet_transform#/media/File:Jpeg2000_2-level_wavelet_transform-lichtenstein.png}{the
  space where the related pixels are found}.

All linear\footnote{Non-linear transform are also possible, but their
  mathematical operation can not be described using linear algebra.}
transforms can be described by matrix-vector
product~\cite{strang4linear} as
\begin{equation}
  y = Kx,
  \label{eq:forward_transform_matrix_form}
\end{equation}
where $x$ is the input signal, $K$ is the analysis transform matrix,
and $y$ is the output decomposition. Notice that
\begin{equation}
  y_i = \langle K_i, x_i\rangle,
\end{equation}
where $K_i$ is the $i$-th row of $K$, and $\langle\cdot,\cdot\rangle$
denotes the
\href{https://mathworld.wolfram.com/InnerProduct.html}{inner
  product}. This basically means that $y_i$ is proportional to the
similarity between the input signal $x$ and the
\href{https://en.wikipedia.org/wiki/Finite_impulse_response}{taps} of
the filter $K_i$. These
\href{https://cseweb.ucsd.edu/classes/fa17/cse166-a/lec13.pdf}{slides}
can help you with this key idea. The inverse (synthesis) transform is
computed by
\begin{equation}
  x = K^{-1}y,
  \label{eq:backward_transform_matrix_form}
\end{equation}
where $K^{-1}$ denotes to the inverse matrix of $K$.

As the rest of transforms, the DWT is also described by the filters of
$K$. Haar found one of the basic wavelets, where
\begin{equation}
  \begin{bmatrix}
    y_0 \\
    y_1
  \end{bmatrix}
  = 
  \begin{bmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{2}} \end{bmatrix}
  \begin{bmatrix}
    x_0 \\
    x_1
  \end{bmatrix},
  \label{eq:Haar_transform}
\end{equation}
and it hold that
\begin{equation}
  K=K^{-1}=K^{\text T},
  \label{eq:orthogonal_matrix}
\end{equation}
where $K^{\text T}$ represents the transpose matrix of $K$. The
Eq.~\ref{eq:orthogonal_matrix} \ref{eq:orthogonal_matrix} is true for all orthogonal transforms,
and therefore
\begin{equation}
  \langle K_i, K_j\rangle = 0, \forall i\neq j.
\end{equation}

\begin{figure}
  \centering
  \myfig{haar_filters_response}{6cm}{600}
  \caption{Haar filters response in the frequency domain (see this
    \href{}{notebook}). $|K_i(e^{j\omega})|$ refeers to the
    modulus of the Fourier transform of $K_i$.}
  \label{fig:haar_filters_response}
\end{figure}

For the Haar transform, $K_0$ describes a low-pass filter and $K_1$ a
high-pass filter (see the Fig.~\ref{fig:haar_filters_response}). As it
can be seen:
\begin{enumerate}
\item There exists aliasing between the filters (for example, the
  central frecuencies of $x$ are in both subbands $y_0$ and $y_1$) and
  this is a drawback because information with the same frequency can
  be found in both subbands and therefore, the concentration of the
  energy of $x$ in one of the subbands is smaller. This problem can be
  only solved using filters that have transfer functions that overlap
  less.
%\item The response of the filter bank is flat, which means that the gain of the different frequencie
%  $|y(e^{j\omega})|=a|x(e^{j\omega})|, a\in\mathbb{R}$ (the
%  reconstructed signal $y$ has not been filtered). % OJO
\item There is not phase distortion (the phase of the filters is a
  linear function of the frequency). This means that all the
  frequencies of $x$ has been delayed the same amount of time in $y$
  (the slope of the linear function), or in other words, that $y$ is a
  delayed copy of $x$.
\end{enumerate}

% Polyphase implementation of the multilevel DWT

Most of the filters that have been found try to:
\begin{enumerate}
\item Remove the aliasing in the low-frequency subband after the
  downsampling, because this improves the quality of the subsampled
  low-pass signal.
\item Minimize the phase distortion, because this distortion produces
  a displacement of the coefficients that reconstruct a region of the
  signal, which difficults the design of entropy codecs for the
  decomposition which exploit the correlation between subbands.
\end{enumerate}

The wavelet filters can be classified

Only for the sake of curiosity, let's check a the Daubechies 

The 1-levels DWT can be computed by a 2-channels PRFB (Perfect
Reconstruction Filter Bank), where the filters $K_i$ are QMFs
(Quadrature Mirror Filters), that is, the response of the filters in the frequency domain are .

\section{What you have to do?}
  
Please, complete this
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/MDWT/MDWT.ipynb}{notebook}.

\section{Timming}

Please, finish this notebook before the next class session.

\section{Deliverables}

None.

\section{Resources}

\bibliography{python}
