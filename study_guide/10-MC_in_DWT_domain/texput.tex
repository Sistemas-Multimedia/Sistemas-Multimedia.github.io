\input{../definitions}
\title{\SM{} - Study Guide - Milestone 8: Motion Compensation in the DWT Domain?}

\maketitle

\section{Description}

\subsection{Removing the temporal redundancy through Motion Compensation (MC)}
The next level in the process of decorrelating the sequence of frames
is to remove the temporal redundancy by means of Motion Compensation
(MC). Basically, MC consist in substracting to the video data a
prediction performed with the information that is avaliable to the
decoder. If this prediction is accurate, the result of this operation
is a residual video with a lower temporal redundancy, that can be
compressed with a higher compression ratio.

\subsection{The lack of shift-invariance in the DWT domain}
In our case, the video data is represented in the MDWT domain (the are
performed the so called in-band motion estimation and
compensation~\cite{andreopoulos2005complete}). Let's suppose that the number of levels of the
DWT is 1, and therefore, each frame has been decomposed into two 2D
subbands $L$ and $H$ (remember that using the notation introduces in
the previous milestone, $H$ has inside the three high-frequency
subbands: $LH$, $HL$ and $HH$, and that $L=LL$). So, after using the
MDET, MC must be performed using the DWT coefficients.

Unfortunately, as a consequence of the downsamplers used during the
DWT to achieve critical sampling and the aliasing between the
subbands, all DWT decompositions are shift-variant. This can be seen
in the Fig.~\ref{fig:dwt_shift_variance} were some DWT coefficients of
a test video with two frames (that are ``empty'' images where a circle
has been moved one pixel to the left) has been shown. As it can be
seen, the value of the coefficients that correspond to the
circunference of the circle are different between different subbands,
and different to the original pixels. This makes quite difficult to
estimate the motion, and therefore, compensate it.

\begin{figure}
  \centering
  \begin{tabular}{ccc}
    \vbox{\pngfig{moving_circle_000}{4cm}{400}} &
    \vbox{\myfig{movement}{4cm}{400}} &
    \vbox{\pngfig{difference}{4cm}{400}} \\
    \vbox{\myfig{haar_LL}{4cm}{400}} &
    \vbox{\myfig{db5_LL}{4cm}{400}} &
    \vbox{\myfig{bior35_LL}{4cm}{400}} \\
    \vbox{\myfig{haar_LH}{4cm}{400}} &
    \vbox{\myfig{db5_LH}{4cm}{400}} &
    \vbox{\myfig{bior35_LH}{4cm}{400}} \\ 
    \vbox{\myfig{haar_HL}{4cm}{400}} &
    \vbox{\myfig{db5_HL}{4cm}{400}} &
    \vbox{\myfig{bior35_HL}{4cm}{400}} \\
    \vbox{\myfig{haar_HH}{4cm}{400}} &
    \vbox{\myfig{db5_HH}{4cm}{400}} &
    \vbox{\myfig{bior35_HH}{4cm}{400}} 
  \end{tabular}
  \caption{A demonstration of the shift-variance of the DWT.}
\label{fig:dwt_shift_variance}
\end{figure}

Shift-variance is also generated after the inverse transform when the
coefficients are filtered or quantized, because the aliasing between
the filters is not completely cancelled in this
case~\cite{bradley2003shift}.

\subsection{Near shift-invariance in the IDWT (Interpolated DWT) domain}
As it was commented before, the causant of the shift-variance in the
critically sampled DWT domain is the use of the downsamplers. At this
point we have basically two different alternatives:
\begin{enumerate}
\item Use the Algorithme \`a Trous~\cite{mallat1999wavelet}, which
  removes the downsamplers from the DWT. Notice that, because the
  downsamplers are removed, the aliasing artifacts produced by the
  downsamplers is also avoided.
\item Regenerate 


\section{What you have to do?}
  
Please, using this
\href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/10-MC_in_DWT_domain/DWT_shift_variance.ipynb}{notebook},
research the posibilities for performing MC of other DWTs available at
\href{https://pywavelets.readthedocs.io/en/latest/}{PyWavelets}.

\section{Timming}

Please, finish this notebook before the next class session.

\section{Deliverables}

None.

\section{Resources}

\bibliography{python}
